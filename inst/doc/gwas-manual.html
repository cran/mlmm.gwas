<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Olivier Guillaume" />

<meta name="date" content="2018-05-04" />

<title>GWAS pipeline manual</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">GWAS pipeline manual</h1>
<h4 class="author"><em>Olivier Guillaume</em></h4>
<h4 class="date"><em>2018-05-04</em></h4>



<style>
    body{
        text-align: justify
    }
    h2{
        border-bottom: 4px solid #ececec;
    }
    h3{
        margin-left: 40px;
    }
    img{
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
</style>
<p>This document explains how to prepare the data and the basic usage of the mlmm.gwas package. Use <code>?functionName</code> in R console to get the complete documentation of a given function.</p>
<p>The pipeline can be divised in 3 main steps:</p>
<ul>
<li>The MLMM where GWAS is carried correcting for population structure while including cofactors through a forward regression approach.</li>
<li>Model selection where the model with the lowest eBIC is selected among the steps of the forward regression</li>
<li>Effects estimation in the selected model</li>
</ul>
<p>Only the additive model is presented in this document. The pipeline also supports additive+dominace, female+male and female+male+interaction models. For more information on how to make the matrices for these models, read <a href="https://link.springer.com/article/10.1007/s00122-017-3003-4">Bonnafous et al. (2017)</a>.</p>
<div id="data" class="section level2">
<h2>Data</h2>
<p>This package includes a dataset with genotypes, phenotypes and kinship for different hybrids of sunflower.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    <span class="kw">library</span>(mlmm.gwas)
    <span class="kw">data</span>(<span class="st">&quot;mlmm.gwas.AD&quot;</span>)
    <span class="kw">ls</span>()
<span class="co">#&gt; [1] &quot;K.add&quot;           &quot;K.dom&quot;           &quot;Xa&quot;              &quot;Xd&quot;             </span>
<span class="co">#&gt; [5] &quot;floweringDateAD&quot;</span></code></pre></div>
<div id="phenotypes-y" class="section level3">
<h3>Phenotypes (Y)</h3>
<p>Phenotypes must be put in a named vector. Names are the individuals’ names and values their phenotypes.</p>
<p>The trait included in the dataset is the flowering date in °C.day.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    <span class="kw">head</span>(floweringDateAD)
<span class="co">#&gt; SF173_SF326  SF160_PNS1 SF031_SF302 SF028_SF332 SF029_SF281  RA22_SF323 </span>
<span class="co">#&gt;    1187.500    1200.520    1152.476    1130.149    1254.520    1215.293</span></code></pre></div>
</div>
<div id="genotypes-matrix-x" class="section level3">
<h3>Genotypes matrix (X)</h3>
<p>It’s a n by m matrix, where n is the number of individuals, and m the number of SNPs.</p>
<p>Be sure to:</p>
<ul>
<li>impute missing genotypes (missing genotypes are not allowed).</li>
<li>remove markers with low Minimum Allelic Frequency (MAF).</li>
<li>remove redondant markers.</li>
<li>center genotypes by markers.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    Xa[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">SNP1</th>
<th align="right">SNP2</th>
<th align="right">SNP3</th>
<th align="right">SNP4</th>
<th align="right">SNP5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SF173_SF326</td>
<td align="right">1.3055556</td>
<td align="right">0.4722222</td>
<td align="right">-0.1944444</td>
<td align="right">-0.1388889</td>
<td align="right">-0.8611111</td>
</tr>
<tr class="even">
<td>SF160_PNS1</td>
<td align="right">-0.6944444</td>
<td align="right">0.4722222</td>
<td align="right">-0.1944444</td>
<td align="right">-0.1388889</td>
<td align="right">-0.8611111</td>
</tr>
<tr class="odd">
<td>SF031_SF302</td>
<td align="right">-0.6944444</td>
<td align="right">0.4722222</td>
<td align="right">-0.1944444</td>
<td align="right">-0.1388889</td>
<td align="right">0.1388889</td>
</tr>
<tr class="even">
<td>SF028_SF332</td>
<td align="right">-0.6944444</td>
<td align="right">0.4722222</td>
<td align="right">-0.1944444</td>
<td align="right">-0.1388889</td>
<td align="right">0.1388889</td>
</tr>
<tr class="odd">
<td>SF029_SF281</td>
<td align="right">-0.6944444</td>
<td align="right">-0.5277778</td>
<td align="right">-0.1944444</td>
<td align="right">-0.1388889</td>
<td align="right">1.1388889</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="kinship-matrix-k" class="section level3">
<h3>“Kinship” matrix (K)</h3>
<p>As K is normalized in the pipeline, you don’t need to do it yourself.</p>
<p>So you can get it from centered X easily:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    ##You can get K from X with the following command line
    ##We are not doing it here because the X matrix included in data(&quot;mlmm.gwas.AD&quot;)
    ##is a subset of a larger matrix.
    <span class="co">#K.add = Xa %*% t(Xa)</span>

    K.add[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">SF173_SF326</th>
<th align="right">SF160_PNS1</th>
<th align="right">SF031_SF302</th>
<th align="right">SF028_SF332</th>
<th align="right">SF029_SF281</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SF173_SF326</td>
<td align="right">213719.258</td>
<td align="right">-2470.409</td>
<td align="right">3375.313</td>
<td align="right">-3872.576</td>
<td align="right">-30046.548</td>
</tr>
<tr class="even">
<td>SF160_PNS1</td>
<td align="right">-2470.409</td>
<td align="right">266025.924</td>
<td align="right">51606.647</td>
<td align="right">22635.758</td>
<td align="right">-29448.215</td>
</tr>
<tr class="odd">
<td>SF031_SF302</td>
<td align="right">3375.313</td>
<td align="right">51606.647</td>
<td align="right">212842.369</td>
<td align="right">16744.480</td>
<td align="right">10089.508</td>
</tr>
<tr class="even">
<td>SF028_SF332</td>
<td align="right">-3872.576</td>
<td align="right">22635.758</td>
<td align="right">16744.480</td>
<td align="right">225864.591</td>
<td align="right">-9349.381</td>
</tr>
<tr class="odd">
<td>SF029_SF281</td>
<td align="right">-30046.548</td>
<td align="right">-29448.215</td>
<td align="right">10089.508</td>
<td align="right">-9349.381</td>
<td align="right">191078.647</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="y-x-and-k-harmonization" class="section level3">
<h3>Y, X and K harmonization</h3>
<p>Individuals and markers must be the sames and in the same order in Y, X and K.</p>
</div>
<div id="genetic-or-physical-map" class="section level3">
<h3>Genetic or physical map</h3>
<p>A genetic or physical map can be used for graphical representation of association (Manhattan plot).</p>
<p>It’s a dataframe with 3 columns:</p>
<ul>
<li>Markers names</li>
<li>Chromosomes or scaffolds names</li>
<li>Positions (genetic or physical, any unit is allowed)</li>
</ul>
<p>Missing data are allowed.</p>
<p>There is no map in the example dataset. We will still be alble to use the <code>manhattan.plot</code> function but the markers will be ordered by their line index in the X matrix, not by genetic or physical position.</p>
</div>
</div>
<div id="association-detection-with-the-mlmm_allmodels-function" class="section level2">
<h2>Association detection with the <em>mlmm_allmodels</em> function</h2>
<p>The function <code>mlmm_allmodels</code> performs GWAS correcting for population structure while including cofactors through a forward regression approach.</p>
<p>Several markers may be associated to a single QTL. The <code>mlmm_allmodels</code> function aims to solve this problem by selecting the closest SNP to each QTL using a forward regression approach. The association p-values of the SNPs are estimated. Then, the SNP with the lowest p-value is used as fixed effect (cofactor). This is repeated, adding one SNP to the fixed effects at each step, until most of the variance is explained or until the maximum number of iterations is reached.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    res_mlmm =<span class="st"> </span><span class="kw">mlmm_allmodels</span>(floweringDateAD, <span class="kw">list</span>(Xa), <span class="kw">list</span>(K.add))
<span class="co">#&gt; null model done! pseudo-h= 0.521 </span>
<span class="co">#&gt; step  1  done! pseudo-h= 0.379 model: Y ~ mu + SNP303 </span>
<span class="co">#&gt; step  2  done! pseudo-h= 0.328 model: Y ~ mu + SNP303 + SNP317 </span>
<span class="co">#&gt; step  3  done! pseudo-h= 0.202 model: Y ~ mu + SNP303 + SNP317 + SNP407 </span>
<span class="co">#&gt; step  4  done! pseudo-h= 0.085 model: Y ~ mu + SNP303 + SNP317 + SNP407 + SNP10 </span>
<span class="co">#&gt; step  5  done! pseudo-h= 0.048 model: Y ~ mu + SNP303 + SNP317 + SNP407 + SNP10 + SNP153 </span>
<span class="co">#&gt; step  6  done! pseudo-h= 0 model: Y ~ mu + SNP303 + SNP317 + SNP407 + SNP10 + SNP153 + SNP375</span></code></pre></div>
<p><code>mlmm_allmodels</code> returns a list with one element per step. Each element is a vector containing the association p-values of each marker.</p>
<p>These p-values can be visualized as a Manhattan plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    <span class="kw">manhattan.plot</span>( res_mlmm )</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="model-selection" class="section level2">
<h2>Model selection</h2>
<p>It is necessary to select a model using a criterion to avoid overfitting. The criterion used here is the eBIC. The model with the lowest eBIC is selected.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    sel_XX =<span class="st"> </span><span class="kw">frommlmm_toebic</span>(<span class="kw">list</span>(Xa), res_mlmm)
    res_eBIC =<span class="st"> </span><span class="kw">eBIC_allmodels</span>(floweringDateAD, sel_XX, <span class="kw">list</span>(K.add), <span class="kw">ncol</span>(Xa))
    
    res_eBIC</code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">BIC</th>
<th align="right">ajout</th>
<th align="right">eBIC_0.5</th>
<th align="right">LogL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mu</td>
<td align="right">301.9261</td>
<td align="right">0.000000</td>
<td align="right">301.9261</td>
<td align="right">-143.9123</td>
</tr>
<tr class="even">
<td>SNP303</td>
<td align="right">289.7766</td>
<td align="right">6.214608</td>
<td align="right">295.9912</td>
<td align="right">-135.4873</td>
</tr>
<tr class="odd">
<td>SNP317</td>
<td align="right">284.9296</td>
<td align="right">11.734067</td>
<td align="right">296.6637</td>
<td align="right">-130.7136</td>
</tr>
<tr class="even">
<td>SNP407</td>
<td align="right">280.5870</td>
<td align="right">16.846055</td>
<td align="right">297.4330</td>
<td align="right">-126.1920</td>
</tr>
<tr class="odd">
<td>SNP10</td>
<td align="right">276.0085</td>
<td align="right">21.668350</td>
<td align="right">297.6768</td>
<td align="right">-121.5525</td>
</tr>
<tr class="even">
<td>SNP153</td>
<td align="right">272.9082</td>
<td align="right">26.265489</td>
<td align="right">299.1737</td>
<td align="right">-117.6522</td>
</tr>
<tr class="odd">
<td>SNP375</td>
<td align="right">266.7063</td>
<td align="right">30.678287</td>
<td align="right">297.3846</td>
<td align="right">-112.2010</td>
</tr>
</tbody>
</table>
</div>
<p>In this example, the model with 1 fixed effect is selected.</p>
</div>
<div id="estimation-of-the-selected-snps-effects" class="section level2">
<h2>Estimation of the selected SNPs effects</h2>
<p>The selected SNPs effects can be estimated with the function <code>Estimation_allmodels</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    sel_XXclass =<span class="st"> </span><span class="kw">fromeBICtoEstimation</span>(sel_XX, res_eBIC)
    effects =<span class="st"> </span><span class="kw">Estimation_allmodels</span>(floweringDateAD, sel_XXclass, <span class="kw">list</span>(K.add))
    
    effects</code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">BLUE</th>
<th align="left">Tukey.Class</th>
<th align="right">Frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SNP303_00</td>
<td align="right">0.000</td>
<td align="left">c</td>
<td align="right">0.1090909</td>
</tr>
<tr class="even">
<td>SNP303_01|10</td>
<td align="right">1164.893</td>
<td align="left">a</td>
<td align="right">0.4818182</td>
</tr>
<tr class="odd">
<td>SNP303_11</td>
<td align="right">1148.923</td>
<td align="left">b</td>
<td align="right">0.4090909</td>
</tr>
<tr class="even">
<td>mu</td>
<td align="right">1215.446</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<p>You can visualize the distributions of the phenotypes of the individuals according to their allelic class for a given SNP using the <code>genotypes.boxplot</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    <span class="kw">genotypes.boxplot</span>(Xa, floweringDateAD, <span class="st">&quot;SNP303&quot;</span>, effects)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The colored symbols represent the Tukey’s classes. Different symbols mean that the means are significantly different.</p>
</div>
<div id="complete-example-script" class="section level2">
<h2>Complete example script</h2>
<p>For convenience, all of the example command lines are compiled below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    <span class="kw">library</span>(mlmm.gwas)
    <span class="kw">data</span>(<span class="st">&quot;mlmm.gwas.AD&quot;</span>)
    
    res_mlmm =<span class="st"> </span><span class="kw">mlmm_allmodels</span>(floweringDateAD, <span class="kw">list</span>(Xa), <span class="kw">list</span>(K.add))
    
    <span class="kw">manhattan.plot</span>( res_mlmm )
    
    sel_XX =<span class="st"> </span><span class="kw">frommlmm_toebic</span>(<span class="kw">list</span>(Xa), res_mlmm)
    res_eBIC =<span class="st"> </span><span class="kw">eBIC_allmodels</span>(floweringDateAD, sel_XX, <span class="kw">list</span>(K.add), <span class="kw">ncol</span>(Xa))
    
    sel_XXclass =<span class="st"> </span><span class="kw">fromeBICtoEstimation</span>(sel_XX, res_eBIC)
    effects =<span class="st"> </span><span class="kw">Estimation_allmodels</span>(floweringDateAD, sel_XXclass, <span class="kw">list</span>(K.add))
    
    <span class="kw">genotypes.boxplot</span>(Xa, floweringDateAD, <span class="st">&quot;SNP303&quot;</span>, effects)</code></pre></div>
<p>You can also run the entire pipeline (without the figures plots) with the function <code>run_entire_gwas_pipeline</code>. This function runs internally the functions <code>mlmm_allmodels</code>, <code>frommlmm_toebic</code>, <code>eBIC_allmodels</code>, <code>fromeBICtoEstimation</code> and <code>Estimation_allmodels</code> and returns a list with the results of the mlmm, eBIC and effects estimation steps.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    results =<span class="st"> </span><span class="kw">run_entire_gwas_pipeline</span>(floweringDateAD, <span class="kw">list</span>(Xa), <span class="kw">list</span>(K.add))
<span class="co">#&gt; null model done! pseudo-h= 0.521 </span>
<span class="co">#&gt; step  1  done! pseudo-h= 0.379 model: Y ~ mu + SNP303 </span>
<span class="co">#&gt; step  2  done! pseudo-h= 0.328 model: Y ~ mu + SNP303 + SNP317 </span>
<span class="co">#&gt; step  3  done! pseudo-h= 0.202 model: Y ~ mu + SNP303 + SNP317 + SNP407 </span>
<span class="co">#&gt; step  4  done! pseudo-h= 0.085 model: Y ~ mu + SNP303 + SNP317 + SNP407 + SNP10 </span>
<span class="co">#&gt; step  5  done! pseudo-h= 0.048 model: Y ~ mu + SNP303 + SNP317 + SNP407 + SNP10 + SNP153 </span>
<span class="co">#&gt; step  6  done! pseudo-h= 0 model: Y ~ mu + SNP303 + SNP317 + SNP407 + SNP10 + SNP153 + SNP375</span>
    <span class="kw">names</span>(results)
<span class="co">#&gt; [1] &quot;pval&quot;    &quot;eBic&quot;    &quot;effects&quot;</span></code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
